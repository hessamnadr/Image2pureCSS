function image2css(){    if (app.documents.length < 1) {    alert("Please open at least one file", "TextExport Error", true);    return;    }    var docRef = app.activeDocument;    docRef.colorSamplers.removeAll();    var fileLineFeed = "";    if ($.os.search(/windows/i) != -1){        fileLineFeed = "windows";        }    else{        fileLineFeed = "macintosh";        }    var size = parseInt(prompt("Hello css!","Input pixel rate"));    var saveFile = File.saveDialog("Please select a file to export the text to:");    if(saveFile == null){        alert("User Cancelled");        return;        }        var fileHtml = new File(saveFile.path+'/index.html');    fileHtml.linefeed = fileLineFeed;    fileHtml.open("w","TEXT","????");    fileHtml.writeln('<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>'+saveFile.name+'</title><link rel="stylesheet" href="style.css"></head><body><div id="'+saveFile.name+'" /></body></html>')    fileHtml.close();    var fileOut = new File(saveFile.path+'/style.css');    fileOut.linefeed = fileLineFeed;    fileOut.open("w", "TEXT", "????");    fileOut.writeln('body{background: black;}')    fileOut.writeln('#'+saveFile.name+'{position: absolute;top: 0;left: 0;width: 0;height: 0;box-shadow:')    //var size = 50;    $.writeln(size)    for(var i=0;i<docRef.width;i+=size){        for(var j=0;j<docRef.height;j+=size){            docRef.colorSamplers.removeAll();            var pixelLoc = [i,j];            var colorSamplerRef = docRef.colorSamplers.add(pixelLoc);            var red= Math.round(colorSamplerRef.color.rgb.red,-1);            var green = Math.round(colorSamplerRef.color.rgb.green,-1);            var blue = Math.round(colorSamplerRef.color.rgb.blue,-1);            if(i+size>=docRef.width && j+size>=docRef.height){                fileOut.writeln(i+'px '+j+'px 0px '+size+'px rgb('+red+','+green+','+blue+');')                }            else{                fileOut.writeln(i+'px '+j+'px 0px '+size+'px rgb('+red+','+green+','+blue+'),')                }            }        }    fileOut.writeln('}')    fileOut.writeln('');    fileOut.writeln('//---------------------------------');    fileOut.writeln('//https://github.com/hessamnadr/Image2pureCSS-Photoshop-script');    fileOut.writeln('//---------------------------------');    fileOut.close();        }image2css()/*  Image2pureCSS Photoshop script  https://github.com/hessamnadr/Image2pureCSS-Photoshop-script*/